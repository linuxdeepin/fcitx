#!/bin/bash

# sleep for a little while to avoid duplicate startup

case "${XDG_SESSION_TYPE}" in
    x11)
        sleep 2
        ;;
    wayland)
        CPUINFO=$(grep "model name" /proc/cpuinfo | awk -F[:@] '{print $2}' | sed 's/ \+$//g'| uniq) 
        if [[ $CPUINFO == "*Loongson*" ]]; then
            sleep 30
        else
            sleep 9
        fi
        ;;
esac

# Test whether fcitx is running correctly with dbus...
fcitx-remote > /dev/null 2>&1

if [ $? = "1" ]; then
    echo "Fcitx seems is not running"
    fcitx
else
    echo "Fcitx is running correctly."
fi
